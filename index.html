<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>프로파일 자동견적</title>

<style>
body{margin:0;font-family:Arial;background:#f6f7fb;}
.header{background:#1e2a45;color:#fff;padding:20px;text-align:center;font-size:20px;font-weight:bold;}
.section{background:#fff;padding:20px;margin-bottom:10px;}
.size-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;}
.size-card{padding:10px;background:#eef1f7;border-radius:10px;text-align:center;cursor:pointer;}
.size-card.active{background:#1e2a45;color:#fff;}
.size-card img{width:100%;max-height:80px;object-fit:contain;margin-bottom:6px;}
input,select{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid #ccc;}
.total-box{font-weight:bold;font-size:18px;margin-top:10px;}
</style>
</head>

<body>

<div class="header">프로파일 자동견적</div>

<div class="section">
<h3>1. 규격 선택</h3>
<div id="sizeGrid" class="size-grid"></div>
</div>

<div class="section">
<h3>2. 길이 / 수량</h3>

<select id="color">
<option value="silver">실버</option>
<option value="black">블랙</option>
</select>

<input type="number" id="length" placeholder="길이(mm)" min="50">
<input type="number" id="qty" placeholder="수량" min="1">

<div class="total-box" id="price">0 원</div>
</div>


<script>

const prices={
2020:{silver:3900,black:6000},
2040:{silver:6900,black:9000},
3030:{silver:8900,black:11000},
3060:{silver:14000,black:18000},
4040:{silver:16000,black:19000},
4080:{silver:28000,black:30000}
};

let selectedSize="2020";

/* ========================= */
/* 규격 버튼 생성 */
/* ========================= */

function createSizeButtons(){
const grid=document.getElementById("sizeGrid");
grid.innerHTML="";

Object.keys(prices).forEach(size=>{

const card=document.createElement("div");
card.className="size-card";

card.innerHTML=`
<img id="img_${size}" src="/images/${size}_silver.png">
<div>${size}</div>
`;

card.onclick=function(){
document.querySelectorAll(".size-card").forEach(c=>c.classList.remove("active"));
card.classList.add("active");
selectedSize=size;
updateImage();
updatePrice();
};

grid.appendChild(card);
});

document.querySelector(".size-card").classList.add("active");
}

/* ========================= */
/* 이미지 변경 */
/* ========================= */

function updateImage(){
const color=document.getElementById("color").value;
document.getElementById(`img_${selectedSize}`).src=
`/images/${selectedSize}_${color}.png`;
}

/* ========================= */
/* 가격 계산 */
/* ========================= */

function calculateLine(size,color,length,qty,tapOne,tapTwo,hole,counter){

if(length<50) return 0;

const unit100=Math.ceil(length/100);
const base100=prices[size][color]/10;

let total=unit100*base100*qty;

total+=300*tapOne;
total+=600*tapTwo;
total+=400*hole;
total+=1000*counter;

return total;
}

function updatePrice(){

const color=document.getElementById("color").value;
const length=parseInt(document.getElementById("length").value)||0;
const qty=parseInt(document.getElementById("qty").value)||0;

const tapOne=parseInt(document.getElementById("tapOneQty").value)||0;
const tapTwo=parseInt(document.getElementById("tapTwoQty").value)||0;
const hole=parseInt(document.getElementById("holeQty").value)||0;
const counter=parseInt(document.getElementById("counterQty").value)||0;

const total=calculateLine(
selectedSize,color,length,qty,tapOne,tapTwo,hole,counter
);

document.getElementById("price").innerText=
total.toLocaleString()+" 원";
}

/* ========================= */
/* 장바구니 */
/* ========================= */

function addToCart(){

const color=document.getElementById("color").value;
const length=parseInt(document.getElementById("length").value)||0;
const qty=parseInt(document.getElementById("qty").value)||0;

const tapOne=parseInt(document.getElementById("tapOneQty").value)||0;
const tapTwo=parseInt(document.getElementById("tapTwoQty").value)||0;
const hole=parseInt(document.getElementById("holeQty").value)||0;
const counter=parseInt(document.getElementById("counterQty").value)||0;

if(!length||!qty){
alert("길이/수량 입력");
return;
}

const total=calculateLine(
selectedSize,color,length,qty,tapOne,tapTwo,hole,counter
);

const div=document.createElement("div");
div.className="cart-item";

div.innerHTML=`
<strong>${selectedSize}</strong> (${color})<br>
길이 ${length}mm / 수량 ${qty}<br>
한쪽탭 ${tapOne} / 양쪽탭 ${tapTwo} / 홀 ${hole} / 카운터 ${counter}<br>
금액 <span class="linePrice">${total.toLocaleString()}</span> 원
<br>
<button onclick="this.parentElement.remove();updateGrand();">삭제</button>
`;

document.getElementById("cartList").appendChild(div);
updateGrand();
}

function updateGrand(){
let sum=0;
document.querySelectorAll(".linePrice").forEach(e=>{
sum+=parseInt(e.innerText.replace(/,/g,''))||0;
});
document.getElementById("grandTotal").innerText=sum.toLocaleString();
}

/* ========================= */
/* 이벤트 */
/* ========================= */

document.addEventListener("input",updatePrice);

document.getElementById("color").addEventListener("change",function(){
updateImage();
updatePrice();
});

document.addEventListener("DOMContentLoaded",function(){
createSizeButtons();
updateImage();
});


</script>

</body>
</html>

