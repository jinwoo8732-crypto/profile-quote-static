<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>관리자 견적 관리</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

<h2>견적 관리</h2>
<table border="1" width="100%">
<thead>
<tr>
<th>ID</th>
<th>총금액</th>
<th>상태</th>
<th>변경</th>
<th>삭제</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>

<script>

const supabase = window.supabase.createClient(
"https://ritzqnjgivmrtysulzil.supabase.co",
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJpdHpxbmpnaXZtcnR5c3VsemlsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE5ODA2MjMsImV4cCI6MjA4NzU1NjYyM30.oTeXacJlkMXKw1G4IRWUa3G2DM1wPvFl-9rzf5IdsxY"
);

async function load(){
const {data}=await supabase.from("quotes").select("*").order("id",{ascending:false});
const tbody=document.getElementById("list");
tbody.innerHTML="";
data.forEach(row=>{
tbody.innerHTML+=`
<tr>
<td>${row.id}</td>
<td>${row.total}</td>
<td>${row.status}</td>
<td>
<select onchange="updateStatus(${row.id},this.value)">
<option>접수</option>
<option>확인중</option>
<option>완료</option>
</select>
</td>
<td><button onclick="del(${row.id})">삭제</button></td>
</tr>
`;
});
}

async function updateStatus(id,val){
await supabase.from("quotes").update({status:val}).eq("id",id);
load();
}

async function del(id){
await supabase.from("quotes").delete().eq("id",id);
load();
}

load();

</script>
</body>
</html>
 
